# 実装計画

- [x] 1. CloudFormationテンプレートの作成
  - API Gateway、Lambda関数、IAMロールを定義するYAMLファイルを作成
  - リソースポリシーでIP制限を設定
  - Lambda関数は空のコードで初期作成
  - _要件: 1.1, 1.2, 1.3, 1.4, 1.5, 1.6_

- [ ] 2. Go言語Lambda関数の実装
  - [x] 2.1 基本構造とデータ型の定義
    - Event、KindleBook、Response構造体を定義
    - time.Timeを使用したReleaseDate処理を実装
    - _要件: 3.1, 3.5_

  - [x] 2.2 S3ファイル読み取り機能の実装
    - AWS SDK for Goを使用してS3からJSONファイルを取得
    - JSONをKindleBook配列にパース
    - エラーハンドリングを実装
    - _要件: 3.2, 3.4, 3.5_

  - [x] 2.3 ASIN削除ロジックの実装
    - 指定されたASINを配列から検索・削除
    - 削除後の配列をJSONに変換
    - ASIN未発見時の404レスポンス処理
    - _要件: 3.2, 3.3, 3.4, 3.5_

  - [x] 2.4 S3ファイル更新機能の実装
    - 更新されたJSONをS3に保存
    - 成功・失敗レスポンスの生成
    - ログ出力の実装
    - _要件: 3.3, 3.4, 3.5_

- [x] 3. Lambdaデプロイスクリプトの作成
  - Go言語コードをLinux用にビルド
  - zipファイルの作成とAWS CLIでのデプロイ
  - エラーハンドリングと成功確認
  - _要件: 4.1, 4.2, 4.3, 4.4, 4.5_

- [x] 4. IP更新バッチスクリプトの作成
  - checkip.amazonaws.comから現在IPを取得
  - API Gatewayリソースポリシーの更新
  - 前回IPとの比較による最適化
  - _要件: 2.1, 2.2, 2.3, 2.4_

- [x] 5. price and point highlighter修正
  - [x] 5.1 API呼び出し関数の実装
    - API GatewayエンドポイントへのDELETEリクエスト
    - ASINをJSONで送信
    - 404レスポンスを正常として処理
    - _要件: 5.1, 5.2, 5.3, 5.4_

  - [x] 5.2 通知送信処理との統合
    - postToAllPlatforms関数内でAPI呼び出しを追加
    - 重複呼び出し防止ロジックの実装
    - エラー時も通常処理を継続
    - _要件: 5.1, 5.2, 5.5_